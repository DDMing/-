# 参考业界架构 考虑程序的扩展

-----------------------
## 负载均衡
- 概念
  负载平衡（Load balancing）是一种计算机网络技术，用来在多个计算机（计算机集群）、网络连接、CPU、磁盘驱动器或其他资源中分配负载，
以达到最佳化资源使用、最大化吞吐率、最小化响应时间、同时避免过载的目的。使用带有负载平衡的多个服务器组件，取代单一的组件，可以通过冗余提高可靠性。
负载平衡服务通常是由专用软体和硬件来完成。

- 负载均衡技术
  - DNS域名解析负载均衡 ![DNS域名解析负载均衡](http://images.cnitblog.com/i/381412/201407/181649235687549.jpg)
    优点:将负载均衡的工作转交给了DNS，省掉了网站管理维护负载均衡服务器的麻烦。
    缺点:
      1 目前的DNS是多级解析，每一级DNS都可能缓存A记录，当某台服务器下线后，即使修改了DNS的A记录，要使其生效仍然需要较长时间。这段期间，会导致用户访问已经下线的服务器造成访问失败。
      2 DNS负载均衡的控制权在域名服务商那里，网站无法对其做更多改善和管理。
  - 反向代理负载均衡 ![反向代理负载均衡](http://images.cnitblog.com/i/381412/201407/182145306624536.jpg)
    Web服务器不需要使用外部IP地址，而反向代理服务器则需要配置双网卡和内外部两套IP地址。
    优点：和反向代理服务器功能集成在一起，部署简单
    缺点：反向代理服务器是所有请求和响应的中转站，其性能可能会成为瓶颈。
  - IP负载均衡![IP负载均衡](http://images.cnitblog.com/i/381412/201407/182157070532417.jpg)
    优点:在内核进程完成数据分发，较反向代理负载均衡（在应用程序中分发数据）有更好的处理性能。
    缺点:由于所有请求响应都需要经过负载均衡服务器，集群的最大响应数据吞吐量不得不受制于负载均衡服务器网卡带宽。
  - 数据链路层负载均衡 ![数据链路层负载均衡](http://images.cnitblog.com/i/381412/201407/182303190069562.jpg)
    此种方式又称作三角传输模式，负载均衡数据分发过程中不修改IP地址，只修改mac地址，由于实际处理请求的真实物理IP地址和数据请求目的IP地址一致，所以不需要通过负载均衡服务器进行地址转换，可将响应数据包直接返回给用户浏览器，避免负载均衡服务器网卡带宽成为瓶颈。这种负载均衡方式又称作直接路由方式（DR）
    在Linux平台上最好的链路层负载均衡开源产品是LVS(Linux Virutal Server).
    
- 负载均衡算法
  - 轮询
  - 加权轮询
  - 随机
  - 最少链接
  - 源地址散列
  
  
### **LVS**
  -IP负载均衡技术
    - **VS/NAT** 主要有通过网络地址转换（Network Address Translation）将一组服务器构成一个高性能的、高可用的虚拟服务器
    - **VS/TUN** 在分析VS/NAT的缺点和网络服务的非对称性的基础上，我们提出了通过IP隧道实现虚拟服务器的方法
    - **VS/TUN** 通过直接路由实现虚拟服务器的方法
    
    
----------------------------
参考来源：
  - [阿里云负载均衡](https://www.aliyun.com/product/slb/)
  - [LVS文档](http://www.linuxvirtualserver.org/zh/lvs3.html)
  - [路人博客1](http://www.cnblogs.com/edisonchou/p/3851333.html)
